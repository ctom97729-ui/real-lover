<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Real Lover Miya ğŸ’–</title>
  <style>
    :root{
      --player-bg: rgba(0,0,0,0.45);
      --accent: hotpink;
    }
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      /* è¯·æŠŠä½ çš„å›¾ç‰‡æ”¾åˆ° assets/background.png */
      background: url('å“²é£å£çº¸ã€‘miya-åŠ¨æ¼« (1).png') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      flex-direction: column;
      height: 100vh;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(4px);
    }

    .chat-box {
      width: 90%;
      max-width: 600px;
      height: 70vh;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      padding: 20px;
      overflow-y: auto;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
      color: white;
    }
    .message {
      margin: 10px 0;
      padding: 10px;
      border-radius: 10px;
    }
    .user {
      background: rgba(255, 255, 255, 0.3);
      text-align: right;
    }
    .miya {
      background: rgba(255, 105, 180, 0.4);
      text-align: left;
    }
    .input-box {
      width: 90%;
      max-width: 600px;
      margin-top: 10px;
      display: flex;
    }
    input {
      flex: 1;
      padding: 10px;
      border-radius: 10px;
      border: none;
      outline: none;
      font-size: 16px;
    }
    button {
      margin-left: 10px;
      padding: 10px 15px;
      border: none;
      border-radius: 10px;
      background: var(--accent);
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    /* é¡¶éƒ¨å·¦ä¸Šè§’æ’­æ”¾å™¨ */
    .bgm-player {
      position: fixed;
      top: 16px;
      left: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      z-index: 2000;
      background: var(--player-bg);
      padding: 8px;
      border-radius: 10px;
      backdrop-filter: blur(6px);
      color: white;
    }
    .bgm-toggle {
      width: 42px;
      height: 42px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(135deg, hotpink, deeppink);
      color: white;
      font-size: 16px;
      cursor: pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: 0 6px 18px rgba(0,0,0,0.3);
    }
    .bgm-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .bgm-controls input[type="range"]{
      width: 120px;
    }
    .bgm-label {
      font-size: 13px;
      opacity: 0.95;
    }

    /* å°æç¤ºï¼ˆå½“éŸ³é¢‘å› æµè§ˆå™¨ç­–ç•¥è¢«é˜»æ­¢æ—¶ï¼‰ */
    .toast {
      position: fixed;
      top: 74px;
      left: 16px;
      z-index: 2000;
      background: rgba(0,0,0,0.6);
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 13px;
      display: none;
    }
    .toast.show { display: block; }

    @media (max-width: 480px){
      .bgm-controls input[type="range"]{ width: 80px; }
      .chat-box { height: 60vh; }
    }
  </style>
</head>
<body>
  <div class="chat-box" id="chat-box">
    <div class="message miya">ğŸ’– Hi, Iâ€™m Miya. Your real lover.</div>
  </div>

  <div class="input-box">
    <input id="userInput" type="text" placeholder="Say something to Miya..." />
    <button onclick="sendMessage()">Send</button>
  </div>

  <!-- éŸ³é¢‘æ–‡ä»¶ï¼šè¯·æ”¾åˆ° assets/bgm.mp3 -->
  <audio id="bgm" src="10æœˆ27æ—¥ æ˜¯ä½ æ•™ä¼šæˆ‘å¦‚ä½•æ‹¨å¼€é˜´éœ¾.MP3" loop preload="auto"></audio>

  <!-- é¡¶éƒ¨å·¦ä¸Šè§’æ’­æ”¾æŒ‰é’®ä¸éŸ³é‡ï¼ˆå§‹ç»ˆå¯è§ï¼Œç”¨æˆ·éœ€æ‰‹åŠ¨ç‚¹å‡»æ’­æ”¾ï¼‰ -->
  <div class="bgm-player" id="bgm-player" aria-hidden="false">
    <button class="bgm-toggle" id="bgm-toggle" title="æ’­æ”¾/æš‚åœ (å¿«æ·é”® P)">â–¶</button>
    <div class="bgm-controls" aria-hidden="false">
      <span class="bgm-label">BGM</span>
      <input id="bgm-volume" type="range" min="0" max="1" step="0.01" value="0.6" aria-label="èƒŒæ™¯éŸ³ä¹éŸ³é‡" />
    </div>
  </div>

  <div id="toast" class="toast">è‹¥æµè§ˆå™¨é˜»æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·ç‚¹å‡»å·¦ä¸Šè§’æ’­æ”¾æŒ‰é’®å¼€å§‹éŸ³ä¹ã€‚</div>

  <script>
    /* èŠå¤©é€»è¾‘ */
    function sendMessage() {
      const input = document.getElementById("userInput");
      const chatBox = document.getElementById("chat-box");
      const userMessage = input.value.trim();
      if (!userMessage) return;

      const userDiv = document.createElement("div");
      userDiv.className = "message user";
      userDiv.textContent = userMessage;
      chatBox.appendChild(userDiv);

      input.value = "";

      const reply = document.createElement("div");
      reply.className = "message miya";
      reply.textContent = "ğŸ’ " + generateReply(userMessage);
      chatBox.appendChild(reply);

      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function generateReply(msg) {
      const lower = msg.toLowerCase();
      if (lower.includes("love")) return "I love you too ğŸ’–";
      if (lower.includes("hi") || lower.includes("hello")) return "Hey darling~ ğŸŒ¸";
      if (lower.includes("who are you")) return "Iâ€™m Miya, your virtual lover ğŸ’«";
      return "Tell me more, my love ğŸŒ™";
    }

    /* BGM æ§åˆ¶ï¼šæ‰‹åŠ¨æ’­æ”¾ï¼ŒæŒ‰é’®ä½äºå·¦ä¸Šè§’ */
    const audio = document.getElementById('bgm');
    const toggleBtn = document.getElementById('bgm-toggle');
    const vol = document.getElementById('bgm-volume');
    const toast = document.getElementById('toast');

    // åˆå§‹åŒ–éŸ³é‡
    audio.volume = parseFloat(vol.value);

    // æ›´æ–°æŒ‰é’®æ˜¾ç¤ºï¼ˆâ–¶ æˆ– â¸ï¼‰
    function updateToggleUI() {
      toggleBtn.textContent = audio.paused ? 'â–¶' : 'â¸';
    }

    // åˆ‡æ¢æ’­æ”¾
    toggleBtn.addEventListener('click', async () => {
      if (audio.paused) {
        try {
          await audio.play();
          localStorage.setItem('bgmPlaying','true');
          toast.classList.remove('show');
        } catch(err) {
          // è¢«æµè§ˆå™¨é˜»æ­¢ï¼šæç¤ºç”¨æˆ·æ‰‹åŠ¨å…è®¸ï¼ˆæŒ‰é’®å·²æ˜¯æ‰‹åŠ¨è§¦å‘ï¼Œé€šå¸¸ä¸ä¼šè¿›è¿™é‡Œï¼‰
          toast.textContent = 'æ’­æ”¾å¤±è´¥ï¼Œè¯·å…è®¸ç½‘ç«™æ’­æ”¾éŸ³é¢‘æˆ–æ£€æŸ¥æµè§ˆå™¨è®¾ç½®ï¼Œç„¶åå†æ¬¡ç‚¹å‡»æ’­æ”¾ã€‚';
          toast.classList.add('show');
        }
      } else {
        audio.pause();
        localStorage.setItem('bgmPlaying','false');
      }
      updateToggleUI();
    });

    // éŸ³é‡æ»‘å—
    vol.addEventListener('input', () => {
      audio.volume = parseFloat(vol.value);
    });

    // æŒ‰ P å¯ä»¥å¿«æ·åˆ‡æ¢æ’­æ”¾ï¼ˆä¾¿äºæµ‹è¯•ï¼‰
    document.addEventListener('keydown', (e) => {
      if (e.key === 'p' || e.key === 'P') {
        toggleBtn.click();
      }
    });

    // é¡µé¢åŠ è½½åï¼šå¦‚æœç”¨æˆ·ä¹‹å‰æ‰‹åŠ¨æ’­æ”¾è¿‡ï¼ˆæœ¬åœ°è®°å½•ï¼‰ï¼Œå°è¯•æ¢å¤æ’­æ”¾ï¼ˆæ³¨æ„ï¼šæµè§ˆå™¨å¯èƒ½ä»é˜»æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œç”¨æˆ·éœ€è¦å†æ¬¡ç‚¹å‡»ï¼‰
    document.addEventListener('DOMContentLoaded', async () => {
      updateToggleUI();
      const wantPlay = localStorage.getItem('bgmPlaying') === 'true';
      if (wantPlay) {
        try {
          await audio.play();
          updateToggleUI();
        } catch (err) {
          // è‡ªåŠ¨/æ¢å¤æ’­æ”¾è¢«é˜»æ­¢ -> æ˜¾ç¤ºæç¤ºï¼Œç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»å·¦ä¸Šè§’æ’­æ”¾æŒ‰é’®å³å¯
          toast.classList.add('show');
        }
      }
    });

    // å½“é¡µé¢å­˜åœ¨å¯¼è‡´é‡è½½ï¼ˆä¾‹å¦‚ç”¨æˆ·ç‚¹å‡»ç«™å†…æœç´¢å¹¶è·³åˆ°å…¶å®ƒé¡µé¢ï¼‰æ—¶ï¼ŒéŸ³é¢‘ä¼šåœæ­¢ï¼Œè¿™æ˜¯æµè§ˆå™¨çš„æ­£å¸¸è¡Œä¸ºã€‚
    // å¦‚æœä½ éœ€è¦è·¨é¡µé¢æŒç»­æ’­æ”¾ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘èƒ½ç»™å‡ºä½¿ç”¨ iframe/å¼¹å‡ºçª—å£æˆ–å•é¡µé¢åº”ç”¨ï¼ˆSPAï¼‰æ–¹æ¡ˆã€‚
  </script>
</body>
</html>
